---
import { getCollection } from 'astro:content';
import OldSystemLayout from '../../layouts/OldSystemLayout.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

const post = Astro.props;
const { Content } = await post.render();
const title = `${post.data.title} - Ps. Jimmi Ames`;
---

<OldSystemLayout title={title}>
    <header id="main-header">
        <nav class="container">
            <div class="logo">
                <a href="/">
                    <img src="/CONTEXTUAL-LOGO19.png?v=2" alt="Contextual Logo">
                </a>
            </div>
            <ul class="nav-links">
                <li><a href="/">Inicio</a></li>
                <li><a href="/blog/">Blog</a></li>
            </ul>
            <div class="mobile-menu-btn">
                <i data-lucide="menu"></i>
            </div>
        </nav>
    </header>

    <main>
        <article class="section">
            <div class="container blog-post-content">
                <div class="post-header" style="margin-bottom: 2rem;">
                    <span class="blog-date" style="color: #2DA9AF; font-weight: 700; text-transform: uppercase; margin-bottom: 0.5rem; display: block;">
                        {post.data.pubDate.toLocaleDateString('es-ES', { day: '2-digit', month: 'long', year: 'numeric' })}
                    </span>
                    <h1 style="color: #8F99C9; font-size: 2.5rem; margin-bottom: 1rem;">{post.data.title}</h1>
                    {post.data.heroImage && (
                        <img src={post.data.heroImage} alt={post.data.title} style="width: 100%; max-height: 500px; object-fit: cover; border-radius: 16px; margin-bottom: 2rem; box-shadow: 0 10px 30px rgba(0,0,0,0.1);" />
                    )}
                </div>
                <div class="post-body-content">
                    <Content />
                </div>
            </div>
        </article>
    </main>

    <footer id="main-footer">
        <div class="container">
            <p>Ps. Jimmi Jason Ames Arenas | R.U.C. 10459004420</p>
            <p class="copyright">&copy; 2026 Contextual. Psicoterapia y Formaci√≥n. Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- Floating WhatsApp -->
    <a href="https://wa.me/51994656656" class="floating-whatsapp" target="_blank" aria-label="Chat en WhatsApp">
        <i data-lucide="message-circle"></i>
    </a>
</OldSystemLayout>

<style is:global>
    .blog-post-content {
        max-width: 900px;
        margin: 0 auto;
        padding: 40px 20px;
    }
    .post-body-content {
        font-size: 1.1rem;
        line-height: 1.8;
        color: #2c3e50;
    }
    .post-body-content p {
        margin-bottom: 1.5rem;
    }
    .post-body-content h2 {
        color: #8F99C9;
        margin-top: 2.5rem;
        margin-bottom: 1rem;
        font-size: 1.8rem;
    }
    .post-body-content img {
        border-radius: 12px;
        max-width: 100%;
        height: auto;
    }
    .section {
        padding: 60px 0;
    }
</style>
