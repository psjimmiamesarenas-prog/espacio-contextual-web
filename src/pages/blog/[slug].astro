---
import { getCollection } from 'astro:content';
import OldSystemLayout from '../../layouts/OldSystemLayout.astro';

export async function getStaticPaths() {
	const posts = await getCollection('blog');
	return posts.map((post) => ({
		params: { slug: post.slug },
		props: post,
	}));
}

const post = Astro.props;
const { Content } = await post.render();
const title = `${post.data.title} - Ps. Jimmi Ames`;
---

<OldSystemLayout title={title}>
    <header id="main-header">
        <nav class="container">
            <div class="logo">
                <a href="/">
                    <img src="/CONTEXTUAL-LOGO19.png?v=2" alt="Contextual Logo">
                </a>
            </div>
            <ul class="nav-links">
                <li><a href="/">Inicio</a></li>
                <li><a href="/blog/">Blog</a></li>
            </ul>
            <div class="mobile-menu-btn">
                <i data-lucide="menu"></i>
            </div>
        </nav>
    </header>

    <main>
        <article class="article-page-section">
            <div class="container blog-post-content">
                <div class="post-header">
                    <span class="blog-date-slug">
                        {post.data.pubDate.toLocaleDateString('es-ES', { day: '2-digit', month: 'long', year: 'numeric' })}
                    </span>
                    <h1 class="post-title">{post.data.title}</h1>
                    {post.data.heroImage && (
                        <img src={post.data.heroImage} alt={post.data.title} class="post-hero-image" />
                    )}
                </div>
                <div class="post-body-content">
                    <Content />
                </div>
            </div>
        </article>
    </main>

    <footer id="main-footer">
        <div class="container">
            <p>Ps. Jimmi Jason Ames Arenas | R.U.C. 10459004420</p>
            <p class="copyright">&copy; 2026 Contextual. Psicoterapia y Formaci√≥n. Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- Floating WhatsApp -->
    <a href="https://wa.me/51994656656" class="floating-whatsapp" target="_blank" aria-label="Chat en WhatsApp">
        <i data-lucide="message-circle"></i>
    </a>
</OldSystemLayout>
